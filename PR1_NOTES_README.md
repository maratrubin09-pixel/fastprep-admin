# PR1: Internal Notes (–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏)

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### Backend:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ `conversation_notes` (–º–∏–≥—Ä–∞—Ü–∏—è `201_notes.sql`)
- ‚úÖ –°–µ—Ä–≤–∏—Å `NotesService` —Å –º–µ—Ç–æ–¥–∞–º–∏:
  - `get(conversationId, userId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏
  - `upsert(conversationId, userId, noteText)` - —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  - `remove(conversationId, userId)` - —É–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `NotesController` —Å endpoints:
  - `GET /api/inbox/conversations/:id/notes`
  - `POST /api/inbox/conversations/:id/notes`
  - `DELETE /api/inbox/conversations/:id/notes`
- ‚úÖ WebSocket —Å–æ–±—ã—Ç–∏—è: `note.upserted`, `note.deleted`
- ‚úÖ HTML sanitization –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Frontend:
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `NotePanel` (–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ)
- ‚úÖ –ò–∫–æ–Ω–∫–∞ –∑–∞–º–µ—Ç–∫–∏ –≤ header —á–∞—Ç–∞
- ‚úÖ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage –∫–∞–∫ fallback

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π —á–∞—Ç –≤ Unified Inbox
2. –ù–∞–∂–º–∏—Ç–µ –∏–∫–æ–Ω–∫—É –∑–∞–º–µ—Ç–∫–∏ (üìù) –≤ header —á–∞—Ç–∞
3. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ "Save"
4. –ó–∞–∫—Ä–æ–π—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç —Å–Ω–æ–≤–∞ - –∑–∞–º–µ—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–º–µ—Ç–∫–∞ –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –≤–∞–º (–Ω–µ –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Ç–∞—Ö)
6. –£–¥–∞–ª–∏—Ç–µ –∑–∞–º–µ—Ç–∫—É –∫–Ω–æ–ø–∫–æ–π "Delete"

## –°–∫—Ä–∏–Ω—à–æ—Ç—ã

[–î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç NotePanel]

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –ù–µ—Ç unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è NotesService
- –ù–µ—Ç e2e —Ç–µ—Å—Ç–æ–≤ –¥–ª—è flow –∑–∞–º–µ—Ç–æ–∫

